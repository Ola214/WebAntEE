CREATE TABLE CUSTOMER
(
	ID INTEGER primary key GENERATED BY DEFAULT AS IDENTITY,
	NAME VARCHAR(255),
	SURNAME VARCHAR(255),
	EMAIL VARCHAR(255)
);

CREATE TABLE PRODUCT
(
	ID INTEGER primary key GENERATED BY DEFAULT AS IDENTITY,
	NAME VARCHAR(255),
	PRICE DECIMAL
);

CREATE TABLE PURCHASE
(
	ID INTEGER primary key GENERATED BY DEFAULT AS IDENTITY,
	ID_CUSTOMER INTEGER,
	REALISATION_DATE DATE
);

ALTER TABLE PURCHASE
ADD CONSTRAINT PURCHASE_ID_CUSTOMER
foreign key(ID_CUSTOMER) REFERENCES CUSTOMER(ID) ON DELETE CASCADE;

CREATE TABLE PURCHASE_ITEM
(
	ID INTEGER primary key GENERATED BY DEFAULT AS IDENTITY,
	ID_PURCHASE INTEGER,
	ID_PRODUCT INTEGER,
	QUANTITY BIGINT
);

ALTER TABLE PURCHASE_ITEM
ADD CONSTRAINT PURCHASE_ITEM_ID_PURCHASE
foreign key(ID_PURCHASE) REFERENCES PURCHASE_ITEM(ID) ON DELETE CASCADE;

ALTER TABLE PURCHASE_ITEM
ADD CONSTRAINT PURCHASE_ITEM_ID_PRODUCT
foreign key(ID_PRODUCT) REFERENCES PRODUCT(ID) ON DELETE CASCADE;